<!DOCTYPE module SYSTEM "module.dtd">

<module name="CornerDetection" dir="computer_vision">
  <doc>
    <description>CornerDetection</description>
  </doc>

  <settings>
    <dl_settings>
      <dl_settings name="CornerDetection">
        <dl_setting var="fast_show_features" min="0" step="1" max="1" />
        <dl_setting var="lk_show_optical_flow" min="0" step="1" max="1" />

        <dl_setting var="fast_threshold" min="0" step="1" max="50" />
        <dl_setting var="fast_min_dist" min="0" step="1" max="30" />
        <dl_setting var="fast_x_padding" min="0" step="1" max="135" />
        <dl_setting var="fast_y_padding" min="0" step="1" max="135" />

        <dl_setting var="lk_half_window_size" min="1" step="1" max="30" />
        <dl_setting var="lk_subpixel_factor" min="1" step="1" max="30" />
        <dl_setting var="lk_max_iterations" min="1" step="1" max="20" />
        <dl_setting var="lk_step_threshold" min="0" step="1" max="5" />
        <dl_setting var="lk_max_points" min="1" step="1" max="100" />
      </dl_settings>
    </dl_settings>
  </settings>

  <depends>video_thread</depends>

  <header>
    <file name="corner_detection.h"/>
  </header>

  <init fun="corner_detection_init()"/>

  <makefile target="ap">
    <!-- Include the needed Computer Vision files -->
    <define name="modules/computer_vision" type="include"/>
    <file name="image.c" dir="modules/computer_vision/lib/vision"/>
    <file name="jpeg.c" dir="modules/computer_vision/lib/encoding"/>
    <file name="rtp.c" dir="modules/computer_vision/lib/encoding"/>
    <file name="v4l2.c" dir="modules/computer_vision/lib/v4l"/>

    <!-- The optical flow module (calculator) -->
    <file name="corner_detection.c"/>
    <file name="pprz_algebra_float.c" dir="math"/>
    <file name="pprz_matrix_decomp_float.c" dir="math"/>

    <!-- Main vision calculations -->
    <file name="fast_rosten.c" dir="modules/computer_vision/lib/vision"/>
    <file name="lucas_kanade.c" dir="modules/computer_vision/lib/vision"/>
    <file name="linear_flow_fit.c" dir="modules/computer_vision/opticflow"/>
  </makefile>

</module>

